<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title></title>
  <style type="text/css">code{white-space: pre;}</style>
  <style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
  </style>
  <style type="text/css">
  /*! normalize.css v2.1.3 | MIT License | git.io/normalize */
  
  /* ==========================================================================
     HTML5 display definitions
     ========================================================================== */
  
  /**
   * Correct `block` display not defined in IE 8/9.
   */
  
  article,
  aside,
  details,
  figcaption,
  figure,
  footer,
  header,
  hgroup,
  main,
  nav,
  section,
  summary {
      display: block;
  }
  
  /**
   * Correct `inline-block` display not defined in IE 8/9.
   */
  
  audio,
  canvas,
  video {
      display: inline-block;
  }
  
  /**
   * Prevent modern browsers from displaying `audio` without controls.
   * Remove excess height in iOS 5 devices.
   */
  
  audio:not([controls]) {
      display: none;
      height: 0;
  }
  
  /**
   * Address `[hidden]` styling not present in IE 8/9.
   * Hide the `template` element in IE, Safari, and Firefox < 22.
   */
  
  [hidden],
  template {
      display: none;
  }
  
  /* ==========================================================================
     Base
     ========================================================================== */
  
  /**
   * 1. Set default font family to sans-serif.
   * 2. Prevent iOS text size adjust after orientation change, without disabling
   *    user zoom.
   */
  
  html {
      font-family: sans-serif; /* 1 */
      -ms-text-size-adjust: 100%; /* 2 */
      -webkit-text-size-adjust: 100%; /* 2 */
  }
  
  /**
   * Remove default margin.
   */
  
  body {
      margin: 0;
  }
  
  /* ==========================================================================
     Links
     ========================================================================== */
  
  /**
   * Remove the gray background color from active links in IE 10.
   */
  
  a {
      background: transparent;
  }
  
  /**
   * Address `outline` inconsistency between Chrome and other browsers.
   */
  
  a:focus {
      outline: thin dotted;
  }
  
  /**
   * Improve readability when focused and also mouse hovered in all browsers.
   */
  
  a:active,
  a:hover {
      outline: 0;
  }
  
  /* ==========================================================================
     Typography
     ========================================================================== */
  
  /**
   * Address variable `h1` font-size and margin within `section` and `article`
   * contexts in Firefox 4+, Safari 5, and Chrome.
   */
  
  h1 {
      font-size: 2em;
      margin: 0.67em 0;
  }
  
  /**
   * Address styling not present in IE 8/9, Safari 5, and Chrome.
   */
  
  abbr[title] {
      border-bottom: 1px dotted;
  }
  
  /**
   * Address style set to `bolder` in Firefox 4+, Safari 5, and Chrome.
   */
  
  b,
  strong {
      font-weight: bold;
  }
  
  /**
   * Address styling not present in Safari 5 and Chrome.
   */
  
  dfn {
      font-style: italic;
  }
  
  /**
   * Address differences between Firefox and other browsers.
   */
  
  hr {
      -moz-box-sizing: content-box;
      box-sizing: content-box;
      height: 0;
  }
  
  /**
   * Address styling not present in IE 8/9.
   */
  
  mark {
      background: #ff0;
      color: #000;
  }
  
  /**
   * Correct font family set oddly in Safari 5 and Chrome.
   */
  
  code,
  kbd,
  pre,
  samp {
      font-family: monospace, serif;
      font-size: 1em;
  }
  
  /**
   * Improve readability of pre-formatted text in all browsers.
   */
  
  pre {
      white-space: pre-wrap;
  }
  
  /**
   * Set consistent quote types.
   */
  
  q {
      quotes: "\201C" "\201D" "\2018" "\2019";
  }
  
  /**
   * Address inconsistent and variable font size in all browsers.
   */
  
  small {
      font-size: 80%;
  }
  
  /**
   * Prevent `sub` and `sup` affecting `line-height` in all browsers.
   */
  
  sub,
  sup {
      font-size: 75%;
      line-height: 0;
      position: relative;
      vertical-align: baseline;
  }
  
  sup {
      top: -0.5em;
  }
  
  sub {
      bottom: -0.25em;
  }
  
  /* ==========================================================================
     Embedded content
     ========================================================================== */
  
  /**
   * Remove border when inside `a` element in IE 8/9.
   */
  
  img {
      border: 0;
  }
  
  /**
   * Correct overflow displayed oddly in IE 9.
   */
  
  svg:not(:root) {
      overflow: hidden;
  }
  
  /* ==========================================================================
     Figures
     ========================================================================== */
  
  /**
   * Address margin not present in IE 8/9 and Safari 5.
   */
  
  figure {
      margin: 0;
  }
  
  .figure {
    text-align: center;
  }
  
  .figure .caption {
    font-style: italic;
    font-variant: small-caps;
  }
  
  
  /* ==========================================================================
     Forms
     ========================================================================== */
  
  /**
   * Define consistent border, margin, and padding.
   */
  
  fieldset {
      border: 1px solid #c0c0c0;
      margin: 0 2px;
      padding: 0.35em 0.625em 0.75em;
  }
  
  /**
   * 1. Correct `color` not being inherited in IE 8/9.
   * 2. Remove padding so people aren't caught out if they zero out fieldsets.
   */
  
  legend {
      border: 0; /* 1 */
      padding: 0; /* 2 */
  }
  
  /**
   * 1. Correct font family not being inherited in all browsers.
   * 2. Correct font size not being inherited in all browsers.
   * 3. Address margins set differently in Firefox 4+, Safari 5, and Chrome.
   */
  
  button,
  input,
  select,
  textarea {
      font-family: inherit; /* 1 */
      font-size: 100%; /* 2 */
      margin: 0; /* 3 */
  }
  
  /**
   * Address Firefox 4+ setting `line-height` on `input` using `!important` in
   * the UA stylesheet.
   */
  
  button,
  input {
      line-height: normal;
  }
  
  /**
   * Address inconsistent `text-transform` inheritance for `button` and `select`.
   * All other form control elements do not inherit `text-transform` values.
   * Correct `button` style inheritance in Chrome, Safari 5+, and IE 8+.
   * Correct `select` style inheritance in Firefox 4+ and Opera.
   */
  
  button,
  select {
      text-transform: none;
  }
  
  /**
   * 1. Avoid the WebKit bug in Android 4.0.* where (2) destroys native `audio`
   *    and `video` controls.
   * 2. Correct inability to style clickable `input` types in iOS.
   * 3. Improve usability and consistency of cursor style between image-type
   *    `input` and others.
   */
  
  button,
  html input[type="button"], /* 1 */
  input[type="reset"],
  input[type="submit"] {
      -webkit-appearance: button; /* 2 */
      cursor: pointer; /* 3 */
  }
  
  /**
   * Re-set default cursor for disabled elements.
   */
  
  button[disabled],
  html input[disabled] {
      cursor: default;
  }
  
  /**
   * 1. Address box sizing set to `content-box` in IE 8/9/10.
   * 2. Remove excess padding in IE 8/9/10.
   */
  
  input[type="checkbox"],
  input[type="radio"] {
      box-sizing: border-box; /* 1 */
      padding: 0; /* 2 */
  }
  
  /**
   * 1. Address `appearance` set to `searchfield` in Safari 5 and Chrome.
   * 2. Address `box-sizing` set to `border-box` in Safari 5 and Chrome
   *    (include `-moz` to future-proof).
   */
  
  input[type="search"] {
      -webkit-appearance: textfield; /* 1 */
      -moz-box-sizing: content-box;
      -webkit-box-sizing: content-box; /* 2 */
      box-sizing: content-box;
  }
  
  /**
   * Remove inner padding and search cancel button in Safari 5 and Chrome
   * on OS X.
   */
  
  input[type="search"]::-webkit-search-cancel-button,
  input[type="search"]::-webkit-search-decoration {
      -webkit-appearance: none;
  }
  
  /**
   * Remove inner padding and border in Firefox 4+.
   */
  
  button::-moz-focus-inner,
  input::-moz-focus-inner {
      border: 0;
      padding: 0;
  }
  
  /**
   * 1. Remove default vertical scrollbar in IE 8/9.
   * 2. Improve readability and alignment in all browsers.
   */
  
  textarea {
      overflow: auto; /* 1 */
      vertical-align: top; /* 2 */
  }
  
  /* ==========================================================================
     Tables
     ========================================================================== */
  
  /**
   * Remove most spacing between table cells.
   */
  
  table {
      border-collapse: collapse;
      border-spacing: 0;
  }
  
  .go-top {
  position: fixed;
  bottom: 2em;
  right: 2em;
  text-decoration: none;
  background-color: #E0E0E0;
  font-size: 12px;
  padding: 1em;
  display: inline;
  }
  
  /* Github css */
  
  html,body{
      margin: auto;
      padding-right: 1em;
      padding-left: 1em;
      max-width: 44em;
      color:black;
  }*:not('#mkdbuttons'){margin:0;padding:0}body{font:13.34px helvetica,arial,freesans,clean,sans-serif;-webkit-font-smoothing:subpixel-antialiased;line-height:1.4;padding:3px;background:#fff;border-radius:3px;-moz-border-radius:3px;-webkit-border-radius:3px}p{margin:1em 0}a{color:#4183c4;text-decoration:none}body{background-color:#fff;padding:30px;margin:15px;font-size:14px;line-height:1.6}body>*:first-child{margin-top:0!important}body>*:last-child{margin-bottom:0!important}@media screen{body{box-shadow:0 0 0 1px #cacaca,0 0 0 4px #eee}}h1,h2,h3,h4,h5,h6{margin:20px 0 10px;padding:0;font-weight:bold;-webkit-font-smoothing:subpixel-antialiased;cursor:text}h1{font-size:28px;color:#000}h2{font-size:24px;border-bottom:1px solid #ccc;color:#000}h3{font-size:18px;color:#333}h4{font-size:16px;color:#333}h5{font-size:14px;color:#333}h6{color:#777;font-size:14px}p,blockquote,table,pre{margin:15px 0}ul{padding-left:30px}ol{padding-left:30px}ol li ul:first-of-type{margin-top:0}hr{background:transparent url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAYAAAAECAYAAACtBE5DAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBNYWNpbnRvc2giIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OENDRjNBN0E2NTZBMTFFMEI3QjRBODM4NzJDMjlGNDgiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OENDRjNBN0I2NTZBMTFFMEI3QjRBODM4NzJDMjlGNDgiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo4Q0NGM0E3ODY1NkExMUUwQjdCNEE4Mzg3MkMyOUY0OCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo4Q0NGM0E3OTY1NkExMUUwQjdCNEE4Mzg3MkMyOUY0OCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PqqezsUAAAAfSURBVHjaYmRABcYwBiM2QSA4y4hNEKYDQxAEAAIMAHNGAzhkPOlYAAAAAElFTkSuQmCC) repeat-x 0 0;border:0 none;color:#ccc;height:4px;padding:0}body>h2:first-child{margin-top:0;padding-top:0}body>h1:first-child{margin-top:0;padding-top:0}body>h1:first-child+h2{margin-top:0;padding-top:0}body>h3:first-child,body>h4:first-child,body>h5:first-child,body>h6:first-child{margin-top:0;padding-top:0}a:first-child h1,a:first-child h2,a:first-child h3,a:first-child h4,a:first-child h5,a:first-child h6{margin-top:0;padding-top:0}h1+p,h2+p,h3+p,h4+p,h5+p,h6+p,ul li>:first-child,ol li>:first-child{margin-top:0}dl{padding:0}dl dt{font-size:14px;font-weight:bold;font-style:italic;padding:0;margin:15px 0 5px}dl dt:first-child{padding:0}dl dt>:first-child{margin-top:0}dl dt>:last-child{margin-bottom:0}dl dd{margin:0 0 15px;padding:0 15px}dl dd>:first-child{margin-top:0}dl dd>:last-child{margin-bottom:0}blockquote{border-left:4px solid #DDD;padding:0 15px;color:#777}blockquote>:first-child{margin-top:0}blockquote>:last-child{margin-bottom:0}table{border-collapse:collapse;border-spacing:0;font-size:100%;font:inherit}table th{font-weight:bold;border:1px solid #ccc;padding:6px 13px}table td{border:1px solid #ccc;padding:6px 13px}table tr{border-top:1px solid #ccc;background-color:#fff}table tr:nth-child(2n){background-color:#f8f8f8}img{max-width:100%}code,tt{margin:0 2px;padding:0 5px;white-space:nowrap;border:1px solid #eaeaea;background-color:#f8f8f8;border-radius:3px;font-family:Consolas,'Liberation Mono',Courier,monospace;font-size:12px;color:#333}pre>code{margin:0;padding:0;white-space:pre;border:0;background:transparent}.highlight pre{background-color:#f8f8f8;border:1px solid #ccc;font-size:13px;line-height:19px;overflow:auto;padding:6px 10px;border-radius:3px}pre{background-color:#f8f8f8;border:1px solid #ccc;font-size:13px;line-height:19px;overflow:auto;padding:6px 10px;border-radius:3px}pre code,pre tt{background-color:transparent;border:0}.poetry pre{font-family:Georgia,Garamond,serif!important;font-style:italic;font-size:110%!important;line-height:1.6em;display:block;margin-left:1em}.poetry pre code{font-family:Georgia,Garamond,serif!important;word-break:break-all;word-break:break-word;-webkit-hyphens:auto;-moz-hyphens:auto;hyphens:auto;white-space:pre-wrap}sup,sub,a.footnote{font-size:1.4ex;height:0;line-height:1;vertical-align:super;position:relative}sub{vertical-align:sub;top:-1px}@media print{body{background:#fff}img,pre,blockquote,table,figure{page-break-inside:avoid}body{background:#fff;border:0}code{background-color:#fff;color:#333!important;padding:0 .2em;border:1px solid #dedede}pre{background:#fff}pre code{background-color:white!important;overflow:visible}}@media screen{body.inverted{color:#eee!important;border-color:#555;box-shadow:none}.inverted body,.inverted hr .inverted p,.inverted td,.inverted li,.inverted h1,.inverted h2,.inverted h3,.inverted h4,.inverted h5,.inverted h6,.inverted th,.inverted .math,.inverted caption,.inverted dd,.inverted dt,.inverted blockquote{color:#eee!important;border-color:#555;box-shadow:none}.inverted td,.inverted th{background:#333}.inverted h2{border-color:#555}.inverted hr{border-color:#777;border-width:1px!important}::selection{background:rgba(157,193,200,0.5)}h1::selection{background-color:rgba(45,156,208,0.3)}h2::selection{background-color:rgba(90,182,224,0.3)}h3::selection,h4::selection,h5::selection,h6::selection,li::selection,ol::selection{background-color:rgba(133,201,232,0.3)}code::selection{background-color:rgba(0,0,0,0.7);color:#eee}code span::selection{background-color:rgba(0,0,0,0.7)!important;color:#eee!important}a::selection{background-color:rgba(255,230,102,0.2)}.inverted a::selection{background-color:rgba(255,230,102,0.6)}td::selection,th::selection,caption::selection{background-color:rgba(180,237,95,0.5)}.inverted{background:#0b2531;background:#252a2a}.inverted body{background:#252a2a}.inverted a{color:#acd1d5}}.highlight .c{color:#998;font-style:italic}.highlight .err{color:#a61717;background-color:#e3d2d2}.highlight .k,.highlight .o{font-weight:bold}.highlight .cm{color:#998;font-style:italic}.highlight .cp{color:#999;font-weight:bold}.highlight .c1{color:#998;font-style:italic}.highlight .cs{color:#999;font-weight:bold;font-style:italic}.highlight .gd{color:#000;background-color:#fdd}.highlight .gd .x{color:#000;background-color:#faa}.highlight .ge{font-style:italic}.highlight .gr{color:#a00}.highlight .gh{color:#999}.highlight .gi{color:#000;background-color:#dfd}.highlight .gi .x{color:#000;background-color:#afa}.highlight .go{color:#888}.highlight .gp{color:#555}.highlight .gs{font-weight:bold}.highlight .gu{color:#800080;font-weight:bold}.highlight .gt{color:#a00}.highlight .kc,.highlight .kd,.highlight .kn,.highlight .kp,.highlight .kr{font-weight:bold}.highlight .kt{color:#458;font-weight:bold}.highlight .m{color:#099}.highlight .s{color:#d14}.highlight .na{color:#008080}.highlight .nb{color:#0086b3}.highlight .nc{color:#458;font-weight:bold}.highlight .no{color:#008080}.highlight .ni{color:#800080}.highlight .ne,.highlight .nf{color:#900;font-weight:bold}.highlight .nn{color:#555}.highlight .nt{color:#000080}.highlight .nv{color:#008080}.highlight .ow{font-weight:bold}.highlight .w{color:#bbb}.highlight .mf,.highlight .mh,.highlight .mi,.highlight .mo{color:#099}.highlight .sb,.highlight .sc,.highlight .sd,.highlight .s2,.highlight .se,.highlight .sh,.highlight .si,.highlight .sx{color:#d14}.highlight .sr{color:#009926}.highlight .s1{color:#d14}.highlight .ss{color:#990073}.highlight .bp{color:#999}.highlight .vc,.highlight .vg,.highlight .vi{color:#008080}.highlight .il{color:#099}.highlight .gc{color:#999;background-color:#eaf2f5}.type-csharp .highlight .k,.type-csharp .highlight .kt{color:#00F}.type-csharp .highlight .nf{color:#000;font-weight:normal}.type-csharp .highlight .nc{color:#2b91af}.type-csharp .highlight .nn{color:#000}.type-csharp .highlight .s,.type-csharp .highlight .sc{color:#a31515}
  
  </style>
</head>
<body>
<div id="TOC">
<ul>
<li><a href="#introduction"><span class="toc-section-number">1</span> Introduction</a><ul>
<li><a href="#requirements"><span class="toc-section-number">1.1</span> Requirements</a></li>
<li><a href="#conventions"><span class="toc-section-number">1.2</span> Conventions</a></li>
<li><a href="#notes"><span class="toc-section-number">1.3</span> Notes</a></li>
</ul></li>
<li><a href="#search-node"><span class="toc-section-number">2</span> Search node</a><ul>
<li><a href="#installation"><span class="toc-section-number">2.1</span> Installation</a><ul>
<li><a href="#elasticsearch"><span class="toc-section-number">2.1.1</span> Elasticsearch</a></li>
<li><a href="#clone"><span class="toc-section-number">2.1.2</span> Clone</a></li>
<li><a href="#node-packages"><span class="toc-section-number">2.1.3</span> Node packages</a></li>
<li><a href="#configuration"><span class="toc-section-number">2.1.4</span> Configuration</a></li>
</ul></li>
<li><a href="#ui"><span class="toc-section-number">2.2</span> UI</a></li>
</ul></li>
<li><a href="#angularjs-front-end"><span class="toc-section-number">3</span> AngularJS (front end)</a><ul>
<li><a href="#configuration-1"><span class="toc-section-number">3.1</span> Configuration</a></li>
<li><a href="#loading-the-applications."><span class="toc-section-number">3.2</span> Loading the applications.</a></li>
<li><a href="#bootstrap-process-and-override"><span class="toc-section-number">3.3</span> Bootstrap process and override</a></li>
<li><a href="#development-search-prototype"><span class="toc-section-number">3.4</span> Development (search prototype)</a><ul>
<li><a href="#cache-md5"><span class="toc-section-number">3.4.1</span> Cache + md5</a></li>
<li><a href="#build-process"><span class="toc-section-number">3.4.2</span> Build process</a></li>
<li><a href="#vagrant"><span class="toc-section-number">3.4.3</span> Vagrant</a></li>
</ul></li>
</ul></li>
<li><a href="#drupal-modules"><span class="toc-section-number">4</span> Drupal modules</a><ul>
<li><a href="#installation-1"><span class="toc-section-number">4.1</span> Installation</a></li>
<li><a href="#panels-vs.blocks"><span class="toc-section-number">4.2</span> Panels vs. blocks</a></li>
<li><a href="#configuration-2"><span class="toc-section-number">4.3</span> Configuration</a></li>
<li><a href="#override-search-controller"><span class="toc-section-number">4.4</span> Override search controller</a></li>
</ul></li>
<li><a href="#roadmap"><span class="toc-section-number">5</span> Roadmap</a></li>
<li><a href="#examples"><span class="toc-section-number">6</span> Examples</a></li>
</ul>
</div>
<!-- Ensures that TOC is on it's own page -->

<h1 id="introduction"><span class="header-section-number">1</span> Introduction</h1>
<p><span class="citation">@TODO</span>: Write this section.</p>
<h2 id="requirements"><span class="header-section-number">1.1</span> Requirements</h2>
<p>The guide assumes that you have an installed linux based server with the following packages installed and at least the versions given.</p>
<ul>
<li>nginx 1.4.x</li>
<li>nodeJS 4.0.x</li>
<li>supervisor 3.x</li>
<li>git</li>
<li>Valid SSL certificates for you domain.</li>
</ul>
<h2 id="conventions"><span class="header-section-number">1.2</span> Conventions</h2>
<p>This document uses <strong>[]</strong> square brackets around the different variables in the configuration templates that needs to be exchanged with the actual values from other parts of the configuration (e.g. API keys).</p>
<p>Her is an explanation of the different key configuration variables.</p>
<ul>
<li>[server name]</li>
<li>[client name]</li>
<li>[SSL CERT]</li>
<li>[SSL KEY]</li>
<li>[CHANGE ME]</li>
<li>[PASSWORD]</li>
<li>[SEARCH API KEY]</li>
<li>[SEARCH INDEX KEY]</li>
<li><span class="citation">@TODO</span> Document placeholders […]</li>
</ul>
<pre>
Things in boxes are commands that should be executed or configuration thats need in the files given.
</pre>
<h2 id="notes"><span class="header-section-number">1.3</span> Notes</h2>
<p>To install the newest version (development version that’s not aways stable), you should checkout the development branches in the all the cloned repositories instead of the latest version tag.</p>
<p>The document assumes that you are logged in as the user <em>deploy</em>, if this is not the case, you need to change things (e.g. the supervisor run script etc.).</p>
<p>It also assumes that you are installing in <em>/home/www</em>, which is not the default location on most systems.</p>
<h1 id="search-node"><span class="header-section-number">2</span> Search node</h1>
<p>This part of the guide explains how to get the search node <a href="https://nodejs.org/">nodeJS</a> application installed and started. The search node application is a general purpose application to provide a fast search engine through web-socket connections (using elasticsearch). It was developed during the project <a href="https://github.com/aroskanalen/docs/blob/master/Installation%20guide.md">Aroskanalen</a> but with reusability in mind for other projects.</p>
<h2 id="installation"><span class="header-section-number">2.1</span> Installation</h2>
<p>The installation process requires you clone the application, download node modules and define JSON configuration files.</p>
<h3 id="elasticsearch"><span class="header-section-number">2.1.1</span> Elasticsearch</h3>
<p>Search node used elasticsearch 1.7.x as its search engine and it needs to be installed as well. <em>Note</em> that currently the nodeJS module only supports this as the newest version.</p>
<p>First install Java that is used to run elasticsearch.</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="kw">sudo</span> apt-get install openjdk-7-jre -y <span class="kw">&gt;</span> /dev/null <span class="kw">2&gt;&amp;1</span></code></pre></div>
<p>Download and install the search engine.</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="kw">wget</span> https://download.elastic.co/elasticsearch/elasticsearch/elasticsearch-1.7.1.deb
<span class="kw">sudo</span> dpkg -i elasticsearch-1.7.1.deb
<span class="kw">sudo</span> update-rc.d elasticsearch defaults 95 10</code></pre></div>
<p>To enable ICU support (unicode) please install this plugin, which is required for search node to work properly.</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="kw">sudo</span> /usr/share/elasticsearch/bin/plugin -install elasticsearch/elasticsearch-analysis-icu/2.5.0</code></pre></div>
<p>For debugging elasticsearch this small administration interface can come handy, but its <strong>optional</strong>.</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="kw">sudo</span> /usr/share/elasticsearch/bin/plugin -install mobz/elasticsearch-head</code></pre></div>
<h3 id="clone"><span class="header-section-number">2.1.2</span> Clone</h3>
<p>Next clone the git repository for search node and checkout the latest release tag (which can be found using <em>git tag</em> command inside the repository after the clone).</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="kw">cd</span> /home/www
<span class="kw">git</span> clone git@github.com:search-node/search_node.git
<span class="kw">cd</span> search_node
<span class="kw">git</span> checkout [v1.x.x]</code></pre></div>
<h3 id="node-packages"><span class="header-section-number">2.1.3</span> Node packages</h3>
<p>Search node uses a plugin architecture that requires installation of libraries from the node package manager (npm). The application comes with an installation script to handle this, simply go to the root of the application and execute the script.</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="kw">cd</span> /home/www/search_node/
<span class="kw">./install.sh</span></code></pre></div>
<p><strong>Note</strong>: There are also <em>upgrade</em> and <em>update</em> scripts, where <em>update</em> is used when updating from on version of search node to another to ensure that the right node module versions are used.</p>
<h3 id="configuration"><span class="header-section-number">2.1.4</span> Configuration</h3>
<p>We need to configure nginx to sit in front of the search node so it is accessible through normal web-ports and also proxy web-socket connections from the frontend client (<a href="https://angularjs.org/">AngularJS</a>). So we add the upstream connection configuration in a nodejs configuration file for nginx.</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="kw">sudo</span> nano -w /etc/nginx/sites-available/nodejs</code></pre></div>
<p>Append this upstream connection definition to the file.</p>
<div class="sourceCode"><pre class="sourceCode apache"><code class="sourceCode apache">upstream nodejs_search {
  server 127.0.0.1:3010;
}</code></pre></div>
<p>To access the search node UI and allow communication with the search node a virtual host configuration is needed. You need to change the <em>[server name]</em> with the actual name of the server.</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="kw">sudo</span> nano -w /etc/nginx/sites-available/search_[server name]</code></pre></div>
<div class="sourceCode"><pre class="sourceCode apache"><code class="sourceCode apache">server {
  listen<span class="st"> 80;</span>

  server_name search-[server name];
  rewrite ^ https://$server_name$request_uri? permanent;

  access_log /var/log/nginx/search_access.log;
  error_log /var/log/nginx/search_error.log;
}

<span class="co"># HTTPS server</span>
<span class="co">#</span>
server {
  listen<span class="st"> 443;</span>

  server_name search-[server name];

  access_log /var/log/nginx/search_access.log;
  error_log /var/log/nginx/search_error.log;

  location / {
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header Host $http_host;

    proxy_buffering off;

    proxy_pass http://nodejs_search/;
    proxy_redirect off;
  }

  location /socket.io/ {
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection &quot;upgrade&quot;;

    proxy_pass http://nodejs_search;
  }

  ssl on;
  ssl_certificate /etc/nginx/ssl/[SSL CERT].crt;
  ssl_certificate_key /etc/nginx/ssl/[SSL KEY].key;

  ssl_session_timeout 5m;
  ssl_session_cache shared:SSL:10m;

  <span class="co"># https://hynek.me/articles/hardening-your-web-servers-ssl-ciphers/</span>
  ssl_prefer_server_ciphers On;
  ssl_protocols TLSv1 TLSv1.1 TLSv1.2;
  ssl_ciphers ECDH+AESGCM:DH+AESGCM:ECDH+AES256:DH+AES256:ECDH+AES128:DH+AES:ECDH+3DES:DH+3DES:RSA+AESGCM:RSA+AES:RSA+3DES:!aNULL:!MD5:!DSS;
}</code></pre></div>
<p>Enable the configuration by adding a symbolic links for the search node. The nodejs configuration file should be linked during configuration of the middleware. Restart nginx to enable the configuration.</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="kw">cd</span> /etc/nginx/sites-enabled/
<span class="kw">sudo</span> ln -s /etc/nginx/sites-available/nodejs /etc/nginx/sites-enabled/nodejs
<span class="kw">sudo</span> ln -s /etc/nginx/sites-available/search_[server name] /etc/nginx/sites-enabled/search_[server name]
<span class="kw">sudo</span> service nginx restart</code></pre></div>
<p>Next the application needs to be configured by adding the following content to config.json. Remember to update the administration password and secret.</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="kw">sudo</span> nano -w /home/www/search_node/config.json</code></pre></div>
<div class="sourceCode"><pre class="sourceCode apache"><code class="sourceCode apache">{
  &quot;port&quot;: 3010,
  &quot;secret&quot;: &quot;[CHANGE ME]&quot;,
  &quot;admin&quot;: {
    &quot;username&quot;: &quot;admin&quot;,
    &quot;password&quot;: &quot;[PASSWORD]&quot;
  },
  &quot;log&quot;: {
    &quot;file&quot;: &quot;messages.log&quot;,
    &quot;debug&quot;: false
  },
  &quot;search&quot;: {
    &quot;hosts&quot;: [ &quot;localhost:9200&quot; ],
    &quot;mappings&quot;: &quot;mappings.json&quot;
  },
  &quot;apikeys&quot;: &quot;apikeys.json&quot;
}</code></pre></div>
<p>Before the application can be started the <em>apikeys.json</em> and <em>mappings.json</em> needs to exist and at least contain an empty JSON object (<em>{}</em>).</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="kw">echo</span> <span class="st">&#39;{}&#39;</span> <span class="kw">&gt;</span> /home/www/search_node/apikeys.json
<span class="kw">echo</span> <span class="st">&#39;{}&#39;</span> <span class="kw">&gt;</span> /home/www/search_node/mappings.json</code></pre></div>
<p>The search node needs to be started at boot time which requires a Supervisor run script. Supervisor will also ensure that the node application is restarted, if an error happens and it stops unexpectedly.</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="kw">sudo</span> nano -w /etc/supervisor/conf.d/search_node.conf</code></pre></div>
<p>Supervisor run script for the search node.</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash">[<span class="kw">program</span>:search-node]
<span class="ot">command=</span>node <span class="kw">/home/www/search_node/app.js</span>
<span class="ot">autostart=</span>true
<span class="ot">autorestart=</span>true
<span class="ot">environment=</span>NODE_ENV=<span class="kw">production</span>
<span class="ot">stderr_logfile=</span>/var/log/search-node.err.log
<span class="ot">stdout_logfile=</span>/var/log/search-node.out.log
<span class="ot">user=</span>deploy</code></pre></div>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="kw">sudo</span> service supervisor restart</code></pre></div>
<p>As mentioned the search node is not specially created for aroskanalen, so the mappings (configuration for elasticsearch) can be somewhat complex to setup in the UI. To get you started the mapping below can be used as a template for the configuration.</p>
<p>As we need the UI to complete the setup correctly the node application needs to have write access to the files.</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="kw">cd</span> /home/www/search_node/
<span class="kw">chmod</span> +w apikeys.json mappings.json</code></pre></div>
<p>Now use the UI (https://search-[server name].aroskanalen.dk)</p>
<p>When you have update the mappings file go back into the UI and select the indexes that you need by edit the API key and select it/them in the edit window. Before a given index can be used you need to activate it in the <em>indexes</em> tab. So do that now.</p>
<h2 id="ui"><span class="header-section-number">2.2</span> UI</h2>
<p><span class="citation">@TODO</span>: How to use the UI to add more configuration.</p>
<p>and create a new index using the mappings tabs in the UI and add the mappings that you require for a given index. We will go into details about how to configure the mappings correctly in the UI section and in the Drupal section we will show an example for an simple Drupal entity. After the a index have been created (and activated)</p>
<p>After having create an</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="kw">cat</span> /home/www/search_node/mappings.json</code></pre></div>
<div class="sourceCode"><pre class="sourceCode json"><code class="sourceCode json"><span class="fu">{</span>
  <span class="dt">&quot;795359dd2c81fa41af67faa2f9adbd32&quot;</span><span class="fu">:</span> <span class="fu">{</span>
    <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;demo&quot;</span><span class="fu">,</span>
    <span class="dt">&quot;tag&quot;</span><span class="fu">:</span> <span class="st">&quot;private&quot;</span><span class="fu">,</span>
    <span class="dt">&quot;fields&quot;</span><span class="fu">:</span> <span class="ot">[</span>
      <span class="fu">{</span>
        <span class="dt">&quot;field&quot;</span><span class="fu">:</span> <span class="st">&quot;title&quot;</span><span class="fu">,</span>
        <span class="dt">&quot;type&quot;</span><span class="fu">:</span> <span class="st">&quot;string&quot;</span><span class="fu">,</span>
        <span class="dt">&quot;language&quot;</span><span class="fu">:</span> <span class="st">&quot;da&quot;</span><span class="fu">,</span>
        <span class="dt">&quot;country&quot;</span><span class="fu">:</span> <span class="st">&quot;DK&quot;</span><span class="fu">,</span>
        <span class="dt">&quot;default_analyzer&quot;</span><span class="fu">:</span> <span class="st">&quot;string_index&quot;</span><span class="fu">,</span>
        <span class="dt">&quot;sort&quot;</span><span class="fu">:</span> <span class="kw">true</span><span class="fu">,</span>
        <span class="dt">&quot;indexable&quot;</span><span class="fu">:</span> <span class="kw">true</span>
      <span class="fu">}</span><span class="ot">,</span>
      <span class="fu">{</span>
        <span class="dt">&quot;field&quot;</span><span class="fu">:</span> <span class="st">&quot;name&quot;</span><span class="fu">,</span>
        <span class="dt">&quot;type&quot;</span><span class="fu">:</span> <span class="st">&quot;string&quot;</span><span class="fu">,</span>
        <span class="dt">&quot;language&quot;</span><span class="fu">:</span> <span class="st">&quot;da&quot;</span><span class="fu">,</span>
        <span class="dt">&quot;country&quot;</span><span class="fu">:</span> <span class="st">&quot;DK&quot;</span><span class="fu">,</span>
        <span class="dt">&quot;default_analyzer&quot;</span><span class="fu">:</span> <span class="st">&quot;string_index&quot;</span><span class="fu">,</span>
        <span class="dt">&quot;sort&quot;</span><span class="fu">:</span> <span class="kw">true</span><span class="fu">,</span>
        <span class="dt">&quot;indexable&quot;</span><span class="fu">:</span> <span class="kw">true</span>
      <span class="fu">}</span>
    <span class="ot">]</span><span class="fu">,</span>
    <span class="dt">&quot;dates&quot;</span><span class="fu">:</span> <span class="ot">[</span>
      <span class="st">&quot;created_at&quot;</span><span class="ot">,</span>
      <span class="st">&quot;updated_at&quot;</span>
    <span class="ot">]</span>
  <span class="fu">}</span>
<span class="fu">}</span></code></pre></div>
<p><strong>Note</strong> api-keys “R” vs. “RW” to protect search index.</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="kw">cat</span> apikeys.json</code></pre></div>
<div class="sourceCode"><pre class="sourceCode json"><code class="sourceCode json"><span class="fu">{</span>
  <span class="dt">&quot;795359dd2c81fa41af67faa2f9adbd32&quot;</span><span class="fu">:</span> <span class="fu">{</span>
    <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;Test&quot;</span><span class="fu">,</span>
    <span class="dt">&quot;expire&quot;</span><span class="fu">:</span> <span class="dv">300</span><span class="fu">,</span>
    <span class="dt">&quot;indexes&quot;</span><span class="fu">:</span> <span class="ot">[</span>
      <span class="st">&quot;e7df7cd2ca07f4f1ab415d457a6e1c13&quot;</span>
    <span class="ot">]</span><span class="fu">,</span>
    <span class="dt">&quot;access&quot;</span><span class="fu">:</span> <span class="st">&quot;rw&quot;</span>
  <span class="fu">}</span>
<span class="fu">}</span></code></pre></div>
<h1 id="angularjs-front-end"><span class="header-section-number">3</span> AngularJS (front end)</h1>
<p>The search front-end that users interact with is written in <a href="https://angularjs.org/">AngularJS</a> and is developed in the <a href="https://github.com/search-node/searchpt">search prototype</a> git repository. The script files that should be used in production is the minified versions that are build using a <a href="http://gulpjs.com/">gulp</a> task and is located in the build folder.</p>
<p>The Angular front-end is in fact to applications that communicates with each other, namely search box and search results. It’s divided into two applications to create a more flexible front end, that can be placed in different regions on a given page. This also makes it easier to integrate the search into existing CMS frameworks.</p>
<p>The Angular application(s) can use different providers, so it’s possible to search via search node or in a JSON data file for faster prototype testing (JSON provider correctly don’t support all feature sets yet). One could also create a whole new provider to send search request to third party search engines.</p>
<p>It’s build using these parts seen from a top-down view.</p>
<ul>
<li>Views (templates)
<ul>
<li>Search box (plus filters)</li>
<li>Search results (plus pager and searching spinner)</li>
<li>Directives
<ul>
<li>KeyCode (capture keyboard events)</li>
<li>Pager</li>
</ul></li>
</ul></li>
<li>Controllers
<ul>
<li>Search box</li>
<li>Results</li>
</ul></li>
<li>Services
<ul>
<li>Search proxy (sends work to configured provider)</li>
<li>Communication (handle events between the to applications)</li>
</ul></li>
<li>Providers
<ul>
<li>Search node</li>
<li>JSON</li>
</ul></li>
</ul>
<p>The figure below show how these different components interact with each other and how the date flow is between the two Angular applications. The figure also shows that the configuration is load as an Angular module and is accessible through independency injection (<em>CONFIG</em>) throughout the whole framework.</p>
<div class="figure">
<img src="./images/search_page.png" title="Search node framework" alt="Search node framework" />
<p class="caption">Search node framework</p>
</div>
<h2 id="configuration-1"><span class="header-section-number">3.1</span> Configuration</h2>
<p>The whole setup is highly configurable and can easily be modified through the configuration (and it’s behaviour can be changed by coping, modifying and overriding the contorllers). The configuration is loaded as an Angular module, that can be auto-generated from within a CMS framework or simply typed by hand and added to the page before the application is loaded.</p>
<p>The configuration is defined in JSON and is divided into three parts.</p>
<ul>
<li>Basic configuration
<ul>
<li>Id (required) - Unique id for this instanced (used in cache id’s for localstorage).</li>
<li>initialQueryText (optiona) - Search that will be executed on page load.</li>
</ul></li>
<li>Templates (all required)
<ul>
<li>box - The template used to generate the search box and filters area.</li>
<li>result - The results listing template and also the searching spinner.</li>
<li>pager - The template used by the pager.</li>
</ul></li>
<li>Provider
<ul>
<li>service (required) - The provider to use.</li>
<li>All other are provide configuration options.</li>
</ul></li>
</ul>
<p>The example below is for the search node provider and show the different options available for that provider. The <a href="https://github.com/search-node/searchpt">search prototype</a> repository contains example configuration for the different providers.</p>
<div class="sourceCode"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="va">angular</span>.<span class="at">module</span>(<span class="st">&#39;searchAppConfig&#39;</span><span class="op">,</span> [])
  .<span class="at">constant</span>(<span class="st">&#39;CONFIG&#39;</span><span class="op">,</span> <span class="op">{</span>
    <span class="st">&#39;id&#39;</span> <span class="op">:</span> <span class="st">&#39;Search prototype&#39;</span><span class="op">,</span>
    <span class="st">&#39;initialQueryText&#39;</span><span class="op">:</span> <span class="st">&#39;&#39;</span><span class="op">,</span>
    <span class="st">&#39;templates&#39;</span><span class="op">:</span> <span class="op">{</span>
      <span class="st">&#39;box&#39;</span><span class="op">:</span> <span class="st">&#39;/js/views/search.html&#39;</span><span class="op">,</span>
      <span class="st">&#39;result&#39;</span><span class="op">:</span> <span class="st">&#39;/js/views/result.html&#39;</span><span class="op">,</span>
      <span class="st">&#39;pager&#39;</span><span class="op">:</span> <span class="st">&#39;/js/directive/pager-directive.html&#39;</span>
    <span class="op">},</span>
    <span class="st">&#39;provider&#39;</span><span class="op">:</span> <span class="op">{</span>
      <span class="st">&#39;service&#39;</span><span class="op">:</span> <span class="st">&#39;searchNodeProvider&#39;</span><span class="op">,</span>
      <span class="st">&#39;host&#39;</span><span class="op">:</span> <span class="st">&#39;https://search.node.vm&#39;</span><span class="op">,</span>
      <span class="st">&#39;auth&#39;</span><span class="op">:</span> <span class="st">&#39;/auth.php&#39;</span><span class="op">,</span>
      <span class="st">&#39;index&#39;</span><span class="op">:</span> <span class="st">&#39;e7df7cd2ca07f4f1ab415d457a6e1c13&#39;</span><span class="op">,</span>
      <span class="st">&#39;fields&#39;</span><span class="op">:</span> [<span class="st">&#39;title&#39;</span><span class="op">,</span> <span class="st">&#39;body:value&#39;</span>]<span class="op">,</span>
      <span class="st">&#39;pager&#39;</span><span class="op">:</span> <span class="op">{</span>
        <span class="st">&#39;size&#39;</span><span class="op">:</span> <span class="dv">8</span><span class="op">,</span>
        <span class="st">&#39;page&#39;</span><span class="op">:</span> <span class="dv">0</span>
      <span class="op">},</span>
      <span class="st">&#39;cacheExpire&#39;</span><span class="op">:</span> <span class="dv">30</span><span class="op">,</span>
      <span class="st">&#39;intervals&#39;</span><span class="op">:</span> [<span class="st">&#39;created&#39;</span>]<span class="op">,</span>
      <span class="st">&#39;filters&#39;</span><span class="op">:</span> [
        <span class="op">{</span>
          <span class="st">&#39;field&#39;</span><span class="op">:</span> <span class="st">&#39;field_level&#39;</span><span class="op">,</span>
          <span class="st">&#39;name&#39;</span><span class="op">:</span> <span class="st">&#39;Level&#39;</span><span class="op">,</span>
          <span class="st">&#39;type&#39;</span><span class="op">:</span> <span class="st">&#39;and&#39;</span><span class="op">,</span>
          <span class="st">&#39;terms&#39;</span><span class="op">:</span> <span class="op">{</span>
            <span class="st">&quot;First&quot;</span><span class="op">:</span> <span class="op">{</span>
              <span class="st">&#39;value&#39;</span><span class="op">:</span> <span class="st">&#39;First&#39;</span>
            <span class="op">},</span>
            <span class="st">&quot;Second&quot;</span><span class="op">:</span> <span class="op">{</span>
              <span class="st">&#39;value&#39;</span><span class="op">:</span> <span class="st">&#39;Second&#39;</span>
            <span class="op">},</span>
            <span class="st">&quot;Third&quot;</span><span class="op">:</span> <span class="op">{</span>
              <span class="st">&#39;value&#39;</span><span class="op">:</span> <span class="st">&#39;Third&#39;</span>
            <span class="op">},</span>
            <span class="st">&quot;Fourth&quot;</span><span class="op">:</span> <span class="op">{</span>
              <span class="st">&#39;value&#39;</span><span class="op">:</span> <span class="st">&#39;Fourth&#39;</span>
            <span class="op">},</span>
          <span class="op">}</span>
        <span class="op">},</span>
        <span class="op">{</span>
          <span class="st">&#39;field&#39;</span><span class="op">:</span> <span class="st">&#39;field_technology&#39;</span><span class="op">,</span>
          <span class="st">&#39;name&#39;</span><span class="op">:</span> <span class="st">&#39;Technology&#39;</span><span class="op">,</span>
          <span class="st">&#39;type&#39;</span><span class="op">:</span> <span class="st">&#39;and&#39;</span><span class="op">,</span>
          <span class="st">&#39;terms&#39;</span><span class="op">:</span> <span class="op">{</span>
            <span class="st">&quot;Angular&quot;</span><span class="op">:</span> <span class="op">{</span>
              <span class="st">&#39;value&#39;</span><span class="op">:</span> <span class="st">&#39;Angular&#39;</span>
            <span class="op">},</span>
            <span class="st">&quot;Javascript&quot;</span><span class="op">:</span> <span class="op">{</span>
              <span class="st">&#39;value&#39;</span><span class="op">:</span> <span class="st">&#39;Javascript&#39;</span>
            <span class="op">},</span>
          <span class="op">}</span>
        <span class="op">}</span>
      ]
    <span class="op">}</span>
  <span class="op">}</span>)<span class="op">;</span></code></pre></div>
<p><span class="citation">@TODO</span>: Above is missing date examples for the search provider.</p>
<h2 id="loading-the-applications."><span class="header-section-number">3.2</span> Loading the applications.</h2>
<p>It’s important to load the different parts off the application in the right order as shown in the example below. This will ensure that the dependencies are resolved correctly.</p>
<div class="sourceCode"><pre class="sourceCode html"><code class="sourceCode html"><span class="co">&lt;!-- Load angular  --&gt;</span>
<span class="kw">&lt;script</span><span class="ot"> src=</span><span class="st">&quot;angular.min.js&quot;</span><span class="kw">&gt;&lt;/script&gt;</span>

<span class="co">&lt;!-- Load the application configuration --&gt;</span>
<span class="kw">&lt;script</span><span class="ot"> src=</span><span class="st">&quot;config.js&quot;</span><span class="kw">&gt;&lt;/script&gt;</span>

<span class="co">&lt;!-- Load the app --&gt;</span>
<span class="kw">&lt;script</span><span class="ot"> src=</span><span class="st">&quot;assets.min.js&quot;</span><span class="kw">&gt;&lt;/script&gt;</span>
<span class="kw">&lt;script</span><span class="ot"> src=</span><span class="st">&quot;search.min.js&quot;</span><span class="kw">&gt;&lt;/script&gt;</span></code></pre></div>
<h2 id="bootstrap-process-and-override"><span class="header-section-number">3.3</span> Bootstrap process and override</h2>
<p>In order to customize the application one can look at the HTML used to bootstrap the application and override the controller used. When you overload the controller you will be able to change the behaviour of the application, such as adding date pop-ups or change the filters to be able to close/open and change the default search behaviour. See <a href="http://ulfiaarhus.dk/dagtilbud">http://ulfiaarhus.dk</a> as an example of a override that adds new look and fell to the applications.</p>
<div class="sourceCode"><pre class="sourceCode html"><code class="sourceCode html"><span class="co">&lt;!-- Search box and filters --&gt;</span>
<span class="kw">&lt;div</span><span class="ot"> id=</span><span class="st">&quot;searchBoxApp&quot;</span><span class="ot"> data-ng-strict-di data-ng-controller=</span><span class="st">&quot;boxController&quot;</span><span class="kw">&gt;</span>
  <span class="kw">&lt;span</span><span class="ot"> data-ng-include=</span><span class="st">&quot;template&quot;</span><span class="kw">&gt;</span>
    JavaScript have not been loaded.
  <span class="kw">&lt;/span&gt;</span>
<span class="kw">&lt;/div&gt;</span>

<span class="co">&lt;!-- Results, spinner and pager --&gt;</span>
<span class="kw">&lt;div</span><span class="ot"> id=</span><span class="st">&quot;searchResultApp&quot;</span><span class="ot"> data-ng-strict-di data-ng-controller=</span><span class="st">&quot;resultController&quot;</span> <span class="kw">&gt;</span>
  <span class="kw">&lt;span</span><span class="ot"> data-ng-include=</span><span class="st">&quot;template&quot;</span><span class="kw">&gt;</span>
    JavaScript have not been loaded.
  <span class="kw">&lt;/span&gt;</span>
<span class="kw">&lt;/div&gt;</span></code></pre></div>
<p><span class="citation">@TODO</span>: Explain how the to applications are bootstrapped and how to override the controllers.</p>
<h2 id="development-search-prototype"><span class="header-section-number">3.4</span> Development (search prototype)</h2>
<p><span class="citation">@TODO</span>: Why the searchpt project and how to contribute to the solution.</p>
<h3 id="cache-md5"><span class="header-section-number">3.4.1</span> Cache + md5</h3>
<p><span class="citation">@TODO</span>: What is cached and how is the cache controlled.</p>
<h3 id="build-process"><span class="header-section-number">3.4.2</span> Build process</h3>
<p><span class="citation">@TODO</span>: How to build a new version of the minified files.</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="kw">gulp</span> build --production</code></pre></div>
<h3 id="vagrant"><span class="header-section-number">3.4.3</span> Vagrant</h3>
<p><span class="citation">@TODO</span>: The vagrant used to do the development and what it sets up.</p>
<h1 id="drupal-modules"><span class="header-section-number">4</span> Drupal modules</h1>
<p><span class="citation">@TODO</span>: Explain the modules and what they require and the idea.</p>
<ul>
<li>search_api_search_node</li>
<li><p>search_node_page</p></li>
<li><p>search_node_test_settings</p></li>
</ul>
<h2 id="installation-1"><span class="header-section-number">4.1</span> Installation</h2>
<p>AngularJS in libraries folder (angular/angular.min.js) -&gt; 1.4.x</p>
<p><span class="citation">@TODO</span>: Who to install the modules.</p>
<h2 id="panels-vs.blocks"><span class="header-section-number">4.2</span> Panels vs. blocks</h2>
<p><span class="citation">@TODO</span>: How to use the panes or blocks provide by the modules.</p>
<h2 id="configuration-2"><span class="header-section-number">4.3</span> Configuration</h2>
<p><span class="citation">@TODO</span>: How to configure search API to use search node. <span class="citation">@TODO</span>: How to configure the blocks/panes</p>
<p><span class="citation">@TODO</span>: Index data - cron uri parameter (default/).</p>
<h2 id="override-search-controller"><span class="header-section-number">4.4</span> Override search controller</h2>
<p><span class="citation">@TODO</span>: How to overrride the contoller (in drupal) and link to ulf as an example.</p>
<p>search-node-page-search-box.tpl.php</p>
<div class="sourceCode"><pre class="sourceCode html"><code class="sourceCode html"><span class="kw">&lt;div</span><span class="ot"> id=</span><span class="st">&quot;searchBoxApp&quot;</span><span class="ot"> data-ng-strict-di data-ng-controller=</span><span class="st">&quot;UlfBoxController&quot;</span><span class="kw">&gt;</span>
  <span class="kw">&lt;span</span><span class="ot"> data-ng-include=</span><span class="st">&quot;template&quot;</span><span class="kw">&gt;</span>
    JavaScript have not been loaded.
  <span class="kw">&lt;/span&gt;</span>
<span class="kw">&lt;/div&gt;</span></code></pre></div>
<h1 id="roadmap"><span class="header-section-number">5</span> Roadmap</h1>
<ul>
<li>Type-ahead</li>
<li>Or filters (currently one “and” filters are implemented)</li>
<li>Sorting</li>
<li>Filter on non taxonomy fields</li>
</ul>
<h1 id="examples"><span class="header-section-number">6</span> Examples</h1>
<p>This section lists sites that are using search node.</p>
<ul>
<li>ULF i Aarhus - <a href="http://ulfiaarhus.dk/dagtilbud" class="uri">http://ulfiaarhus.dk/dagtilbud</a></li>
</ul>
</body>
</html>
